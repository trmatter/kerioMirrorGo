<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{.ServiceName}} Status</title>
  <link href="/static/bootstrap/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/font/bootstrap-icons.min.css">
  <style>
    .section-title { display: flex; align-items: center; gap: 0.5em; }
    .ids-badge { font-size: 1.1em; }
    .footer { text-align: center; color: #888; margin-top: 2em; font-size: 0.95em; }
    @media (max-width: 600px) {
      .list-group-horizontal { flex-direction: column; }
    }
  </style>
</head>
<body class="bg-light">
<div class="container py-5">
  <div class="card shadow mb-4">
    <div class="card-body">
      <h1 class="card-title mb-4 section-title">
        <i class="bi bi-speedometer2 text-primary"></i> {{.ServiceName}} <span class="fs-5 text-muted">Dashboard</span>
      </h1>
      <div class="mb-3">
        <i class="bi bi-clock-history"></i> <strong>Current time:</strong> {{.CurrentTime}}
      </div>
      <div class="mb-3">
        <i class="bi bi-arrow-repeat"></i> <strong>Last success update:</strong> {{.LastUpdate}}
      </div>
      <div class="row g-4">
        <div class="col-md-6">
          <h5 class="section-title"><i class="bi bi-gear"></i> Config</h5>
          <ul class="list-group list-group-flush mb-3">
            <li class="list-group-item"><strong>Schedule Interval:</strong> {{.Config.ScheduleInterval}}h</li>
            <li class="list-group-item"><strong>Database Path:</strong> {{.Config.DatabasePath}}</li>
            <li class="list-group-item"><strong>Log Path:</strong> {{.Config.LogPath}}</li>
            <li class="list-group-item"><strong>Proxy URL:</strong> {{.Config.ProxyURL}}</li>
            <li class="list-group-item"><strong>License Number:</strong>
              {{if not .Config.LicenseNumber}}
              <span class="text-warning">Not configured. Please add your license number in settings.</span>
              {{else}}
              {{.Config.LicenseNumber}}
              {{end}}
            </li>
            <li class="list-group-item"><strong>Retry Count:</strong> {{.Config.RetryCount}}</li>
            <li class="list-group-item"><strong>Retry Delay (sec):</strong> {{.Config.RetryDelaySeconds}}</li>
            <li class="list-group-item"><strong>WebFilter API:</strong> {{.Config.WebFilterApi}}</li>
            <li class="list-group-item"><strong>GeoIP4 URL:</strong> {{.Config.GeoIP4Url}}</li>
            <li class="list-group-item"><strong>GeoIP6 URL:</strong> {{.Config.GeoIP6Url}}</li>
            <li class="list-group-item"><strong>GeoLoc URL:</strong> {{.Config.GeoLocUrl}}</li>
            <li class="list-group-item"><strong>Bitdefender URLs:</strong>
              <ul class="mb-0 ps-3">
                {{range .Config.BitdefenderUrls}}
                  <li>{{.}}</li>
                {{end}}
              </ul>
            </li>
          </ul>
        </div>
        <div class="col-md-6">
          <h5 class="section-title"><i class="bi bi-shield-lock"></i> IDS Versions</h5>
          <ul class="list-group list-group mb-3 flex-wrap">            {{range $k, $v := .IDSVersions}}
            <li class="list-group-item d-flex align-items-center flex-column flex-md-row">
              <div class="me-2">
                <strong>IDS{{$k}}:</strong>
                <span class="text-muted small">
                  {{if eq $k "1"}}IPS/IDS Snort (Windows версия)
                  {{else if eq $k "2"}}Списки скомпрометированных адресов
                  {{else if eq $k "3"}}IPS/IDS Snort (версия для Linux до 9.5)
                  {{else if eq $k "4"}}Базы данных GeoIP
                  {{else if eq $k "5"}}IPS/IDS Snort (версия для Linux с 9.5)
                  {{end}}
                </span>
              </div>
              <div class="ms-md-auto mt-2 mt-md-0">
                {{if not (index $.IDSSuccess $k)}}
                  <span class="badge bg-danger ms-2 ids-badge"><i class="bi bi-x-circle"></i> {{$v}}</span>
                {{else if eq $v 0}}
                  <span class="badge bg-danger ms-2 ids-badge"><i class="bi bi-x-circle"></i> {{$v}}</span>
                {{else}}
                  <span class="badge bg-success ms-2 ids-badge"><i class="bi bi-check-circle"></i> {{$v}}</span>
                {{end}}
              </div>
            </li>
            {{end}}
          </ul>
          <h5 class="section-title mt-3"><i class="bi bi-virus2"></i> Bitdefender Database Version</h5>
          <ul class="list-group list-group mb-3 flex-wrap">
            <li class="list-group-item d-flex align-items-center">
              {{if not .BitdefenderSuccess}}
              <span class="badge bg-danger ms-2 ids-badge"><i class="bi bi-x-circle"></i> {{.BitdefenderVer}}</span>
              {{else if eq .BitdefenderVer 0}}
              <span class="badge bg-danger ms-2 ids-badge"><i class="bi bi-x-circle"></i> {{.BitdefenderVer}}</span>
              {{else}}
              <span class="badge bg-success ms-2 ids-badge"><i class="bi bi-check-circle"></i> {{.BitdefenderVer}}</span>
              {{end}}
            </li>
          </ul>
        </div>
      </div>
      <hr class="my-4">
      <div class="d-flex flex-wrap gap-2">
        <a href="/update" class="btn btn-warning btn-lg"><i class="bi bi-arrow-repeat"></i> Manual Update</a>
        <a href="/logs" class="btn btn-secondary btn-lg"><i class="bi bi-journal-text"></i> View Logs</a>
        <a href="/settings" class="btn btn-info btn-lg text-white"><i class="bi bi-sliders"></i> Settings</a>
      </div>
    </div>
  </div>
  <div class="footer">
    &copy; {{.CurrentTime}} &mdash; <span class="text-primary">Kerio Mirror Go</span> | Powered by Go &amp; Bootstrap
  </div>
</div>
</body>
</html>
