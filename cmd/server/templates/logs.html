<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Logs</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .log-area {
      background: #23272b;
      color: #e9ecef;
      font-family: monospace;
      padding: 1rem;
      border-radius: 0.5rem;
      max-height: 70vh;
      overflow-y: auto;
      font-size: 0.95rem;
    }
  </style>
</head>
<body class="bg-light">
<div class="container py-5">
  <div class="card shadow">
    <div class="card-body">
      <h1 class="card-title mb-4">Server Logs</h1>
      <div class="log-area mb-4"><pre id="log-content">{{.LogContent}}</pre></div>
      <a href="/" class="btn btn-primary">Back to Dashboard</a>
      <button id="toggle-autoscroll" class="btn btn-secondary ms-2">Disable Auto-scroll</button>
      <button id="toggle-autoupdate" class="btn btn-secondary ms-2">Disable Auto-update</button>
    </div>
  </div>
</div>
</body>
<script>
let isAutoScrolling = true;
let isAutoUpdating = true;
const logArea = document.querySelector('.log-area');
const toggleScrollButton = document.getElementById('toggle-autoscroll');
const toggleUpdateButton = document.getElementById('toggle-autoupdate');

function fetchLogs() {
  fetch('/logs/raw')
    .then(response => response.text())
    .then(data => {
      document.getElementById('log-content').textContent = data;
      if (isAutoScrolling) {
        logArea.scrollTop = logArea.scrollHeight;
      }
    });
}

toggleScrollButton.addEventListener('click', () => {
  isAutoScrolling = !isAutoScrolling;
  if (isAutoScrolling) {
    toggleScrollButton.textContent = 'Disable Auto-scroll';
    logArea.scrollTop = logArea.scrollHeight;
  } else {
    toggleScrollButton.textContent = 'Enable Auto-scroll';
  }
});

toggleUpdateButton.addEventListener('click', () => {
  isAutoUpdating = !isAutoUpdating;
  if (isAutoUpdating) {
    toggleUpdateButton.textContent = 'Disable Auto-update';
    fetchLogs();
  } else {
    toggleUpdateButton.textContent = 'Enable Auto-update';
  }
});

setInterval(() => {
  if (isAutoUpdating) {
    fetchLogs();
  }
}, 5000);

fetchLogs();
</script>
</html>